<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Epic Games Sanction Lookup</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
      color: #e6edf3;
      padding: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    h1 {
      color: #58a6ff;
      font-size: 2.5rem;
      margin-bottom: 20px;
      text-shadow: 1px 1px 5px rgba(0,0,0,0.5);
    }

    .input-container {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
    }

    input {
      padding: 10px 15px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      outline: none;
      width: 300px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background: #238636;
      border: none;
      color: white;
      border-radius: 8px;
      transition: background 0.3s ease;
      font-weight: bold;
    }

    button:hover {
      background: #2ea043;
    }

    #result {
      width: 100%;
      max-width: 800px;
      margin-top: 20px;
      padding: 20px;
      background: #21262d;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
    }

    .error {
      color: #ff7b72;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .field {
      margin-bottom: 12px;
    }

    .label {
      font-weight: 700;
      color: #58a6ff;
    }

    a {
      color: #58a6ff;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    h3, h4 {
      margin-top: 20px;
      color: #79c0ff;
    }

    pre {
      background: #0d1117;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      color: #c9d1d9;
      font-size: 13px;
    }

  </style>
</head>
<body>
  <h1>Epic Games Sanction Lookup</h1>
  <div class="input-container">
    <input type="text" id="sanctionId" placeholder="Enter sanction ID here">
    <button onclick="fetchSanction()">Lookup</button>
  </div>

  <div id="result"></div>

  <script>
    function formatDate(isoStr) {
      if (!isoStr) return '—';
      const date = new Date(isoStr);
      return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
    }

    function daysUntil(dateStr) {
      if (!dateStr) return '—';
      const now = new Date();
      const end = new Date(dateStr);
      const diff = end - now;
      if (diff < 0) return 'Expired';
      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      return days + ' days remaining';
    }

    async function fetchSanction() {
      const id = document.getElementById('sanctionId').value.trim();
      const resultDiv = document.getElementById('result');
      if (!id) {
        resultDiv.innerHTML = '<p class="error">Please enter a sanction ID.</p>';
        return;
      }

      resultDiv.innerHTML = '<p>Loading...</p>';
      try {
        const url = `https://safety.epicgames.com/api/slate/details?locale=en-US&role=sanctioned_user&sanction_id=${encodeURIComponent(id)}`;
        const proxy = 'https://corsproxy.io/?';
        const response = await fetch(proxy + encodeURIComponent(url));
        if (!response.ok) throw new Error(`Error: ${response.status} ${response.statusText}`);

        const data = await response.json();
        if (!data || !data.sanctions || data.sanctions.length === 0) {
          resultDiv.innerHTML = `<p class="error">No sanctions found for this ID.</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
          return;
        }

        let html = `<h3>Sanction Details</h3>`;
        const s = data.sanctions[0];
        html += `
          <div class="field"><span class="label">Sanction ID:</span> ${s.id}</div>
          <div class="field"><span class="label">Created At:</span> ${formatDate(s.created_at)}</div>
          <div class="field"><span class="label">Expires:</span> ${formatDate(s.expires)} (${daysUntil(s.expires)})</div>
          <div class="field"><span class="label">Revoked At:</span> ${formatDate(s.revoked_at)}</div>
          <div class="field"><span class="label">Type:</span> ${s.type?.name || '—'}</div>
          <div class="field"><span class="label">Description:</span> ${s.type?.description || '—'}</div>
          <div class="field"><span class="label">Sanction Type ID:</span> ${s.sanction_type_id}</div>
          <div class="field"><span class="label">Active:</span> ${s.tas_status_active}</div>
        `;

        html += `<div class="field"><span class="label">Appeal Can Be Created:</span> ${data.appeal_can_be_created}</div>`;
        html += `<div class="field"><span class="label">Appeal Review Status:</span> ${data.appeal_review_status || '—'}</div>`;
        html += `<div class="field"><span class="label">Infraction ID:</span> ${data.infraction_id}</div>`;
        html += `<div class="field"><span class="label">Decision Ground:</span> ${data.decision_ground}</div>`;
        html += `<div class="field"><span class="label">Moderation Means:</span> ${data.moderation_means}</div>`;
        html += `<div class="field"><span class="label">Legal Ground:</span> ${data.legal_ground?.title || '—'} (<a href="${data.legal_ground?.url}" target="_blank">View</a>)</div>`;

        if (data.history && data.history.length > 0) {
          html += `<h4>History</h4>`;
          data.history.forEach(h => {
            html += `<div class="field">${formatDate(h.created_at)} – ${h.event}</div>`;
          });
        }

        html += `<h4>Raw Response</h4><pre>${JSON.stringify(data, null, 2)}</pre>`;
        resultDiv.innerHTML = html;
      } catch (err) {
        resultDiv.innerHTML = `<p class="error">Failed to fetch data. ${err.message}</p>`;
      }
    }
  </script>
</body>
</html>
